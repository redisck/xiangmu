<?php	class BookModel extends Model{		public function get_book_classify(){			$classify=M("Classify");			$classify_book=$classify->where(array('pid'=>1))->select();			return $classify_book;		}		public function get_whole_book(){			$goods=M("Goods");			$whole_book=$goods->where('whole_book=1')->limit(8)->select();			foreach($whole_book as $key=>$value){				$arr=explode("_",$whole_book[$key]['image']);				$whole_book[$key]['image_first']=$arr[0];				$whole_book[$key]['image_last']=$arr[1];				//名字省略字符				$whole_book[$key]['truncate']=truncate($whole_book[$key]['name'],15);				//简介省略字符				$whole_book[$key]['truncate_des']=truncate($whole_book[$key]['description'],30);			}			return $whole_book;		}		public function get_qd_new_book(){			$goods=M("Goods");			$new_book=$goods->where(array('qd_id'=>1,'new_book'=>1))->order('reserve desc')->limit(10)->select();			foreach($new_book as $key=>$value){				$arr=explode("_",$new_book[$key]['image']);				$new_book[$key]['image_first']=$arr[0];				$new_book[$key]['image_last']=$arr[1];				$new_book[$key]['truncate']=truncate($new_book[$key]['name']);			}			return $new_book;		}		public function get_qd_serialize_book(){			$goods=M("Goods");			$serialize_book=$goods->where(array('qd_id'=>1,'serialize_book'=>1))->order('reserve desc')->limit(10)->select();			foreach($serialize_book as $key=>$value){				$arr=explode("_",$serialize_book[$key]['image']);				$serialize_book[$key]['image_first']=$arr[0];				$serialize_book[$key]['image_last']=$arr[1];				$serialize_book[$key]['truncate']=truncate($serialize_book[$key]['name']);			}			return $serialize_book;		}		public function get_qd_end_book(){			$goods=M("Goods");			$end_book=$goods->where(array('qd_id'=>1,'end_book'=>1))->order('reserve desc')->limit(10)->select();			foreach($end_book as $key=>$value){				$arr=explode("_",$end_book[$key]['image']);				$end_book[$key]['image_first']=$arr[0];				$end_book[$key]['image_last']=$arr[1];				$end_book[$key]['truncate']=truncate($end_book[$key]['name']);			}			return $end_book;		}		public function get_qd_hot_book(){			$classify=M("Classify");			$classify_id=$classify->field('id')->where(array('pid'=>1,'status'=>0))->select();			foreach($classify_id as $key=>$value){				$array[]=$value['id'];			}			$goods=M("Goods");			$qd_hot_book=$goods->where(array('qd_id'=>1,'classify_id'=>array('in',$array)))->order("reserve desc")->limit(10)->select();			foreach($qd_hot_book as $key=>$value){				$arr=explode("_",$qd_hot_book[$key]['image']);				$qd_hot_book[$key]['image_first']=$arr[0];				$qd_hot_book[$key]['image_last']=$arr[1];				$qd_hot_book[$key]['truncate']=truncate($qd_hot_book[$key]['name']);				$qd_hot_book[$key]['num']=$key+1;			}			return $qd_hot_book;		}		public function get_qd_author_book(){			$goods=M("Goods");			$qd_author_book=$goods->where("author='唐家三少' or author='我吃西红柿' or author='林家成'")->select();			foreach($qd_author_book as $key=>$value){				$arr=explode("_",$qd_author_book[$key]['image']);				$qd_author_book[$key]['image_first']=$arr[0];				$qd_author_book[$key]['image_last']=$arr[1];				$qd_author_book[$key]['truncate']=truncate($qd_author_book[$key]['name'],15);				$qd_author_book[$key]['truncate_des']=truncate($qd_author_book[$key]['description'],51);			}			foreach($qd_author_book as $key=>$value){				if($value['author']=='唐家三少'){					$a[]=$value;				}				if($value['author']=='我吃西红柿'){					$b[]=$value;				}				if($value['author']=='林家成'){					$c[]=$value;				}			}			$author[]=$a;			$author[]=$b;			$author[]=$c;			return $author;		}		public function get_tr_author_book(){			$goods=M("Goods");			$tr_author_book=$goods->where("author='韩寒' or author='莫言' or author='张小娴'")->select();			foreach($tr_author_book as $key=>$value){				$arr=explode("_",$tr_author_book[$key]['image']);				$tr_author_book[$key]['image_first']=$arr[0];				$tr_author_book[$key]['image_last']=$arr[1];				$tr_author_book[$key]['truncate']=truncate($tr_author_book[$key]['name'],15);				$tr_author_book[$key]['truncate_des']=truncate($tr_author_book[$key]['description'],51);			}			foreach($tr_author_book as $key=>$value){				if($value['author']=='韩寒'){					$a[]=$value;				}				if($value['author']=='莫言'){					$b[]=$value;				}				if($value['author']=='张小娴'){					$c[]=$value;				}			}			$author[]=$a;			$author[]=$b;			$author[]=$c;			return $author;		}		public function get_tr_new_book(){			$goods=M("Goods");			$tr_new_book=$goods->where(array('qd_id'=>0,'new_book'=>1))->limit(10)->select();			foreach($tr_new_book as $key=>$value){				$arr=explode('_',$tr_new_book[$key]['image']);				$tr_new_book[$key]['image_first']=$arr[0];				$tr_new_book[$key]['image_last']=$arr[1];				$tr_new_book[$key]['truncate']=truncate($tr_new_book[$key]['name'],10);				}			return $tr_new_book;		}		public function get_tr_famous_author(){			$goods=M("Goods");			$tr_famous_author=$goods->where(array('qd_id'=>0,'author_book'=>1))->limit(10)->select();			foreach($tr_famous_author as $key=>$value){				$arr=explode('_',$tr_famous_author[$key]['image']);				$tr_famous_author[$key]['image_first']=$arr[0];				$tr_famous_author[$key]['image_last']=$arr[1];				$tr_famous_author[$key]['truncate']=truncate($tr_famous_author[$key]['name'],10);				}			return $tr_famous_author;		}					public function get_tr_hot_search_book(){			$classify=M("Classify");			$classify_id=$classify->field('id')->where(array('pid'=>1,'status'=>0))->select();			foreach($classify_id as $key=>$value){				$array[]=$value['id'];			}			$goods=M("Goods");			$tr_hot_search_book=$goods->where(array('qd_id'=>0,'hot_search'=>1,'classify_id'=>array('in',$array)))->select();			foreach($tr_hot_search_book as $key=>$value){				$arr=explode('_',$tr_hot_search_book[$key]['image']);				$tr_hot_search_book[$key]['image_first']=$arr[0];				$tr_hot_search_book[$key]['image_last']=$arr[1];				$tr_hot_search_book[$key]['truncate']=truncate($tr_hot_search_book[$key]['name'],10);				}			return $tr_hot_search_book;		}				public function get_tr_hot_book(){			$classify=M("Classify");			$classify_id=$classify->field('id')->where(array('pid'=>1,'status'=>0))->select();			foreach($classify_id as $key=>$value){				$array[]=$value['id'];			}			$goods=M("Goods");			$tr_hot_book=$goods->where(array('qd_id'=>0,'classify_id'=>array('in',$array)))->order("reserve desc")->limit(10)->select();			foreach($tr_hot_book as $key=>$value){				$arr=explode("_",$tr_hot_book[$key]['image']);				$tr_hot_book[$key]['image_first']=$arr[0];				$tr_hot_book[$key]['image_last']=$arr[1];				$tr_hot_book[$key]['truncate']=truncate($tr_hot_book[$key]['name']);				$tr_hot_book[$key]['num']=$key+1;			}			return $tr_hot_book;		}		public function get_tr_rq_book(){			$classify=M("Classify");			$classify_id=$classify->field('id')->where(array('pid'=>1,'status'=>0))->select();			foreach($classify_id as $key=>$value){				$array[]=$value['id'];			}			$goods=M("Goods");			$tr_rq_book=$goods->where(array('rq_book'=>1,'qd_id'=>0,'classify_id'=>array('in',$array)))->limit(32)->select();			foreach($tr_rq_book as $key=>$value){				$arr=explode("_",$tr_rq_book[$key]['image']);				$tr_rq_book[$key]['image_first']=$arr[0];				$tr_rq_book[$key]['image_last']=$arr[1];				$tr_rq_book[$key]['truncate']=truncate($tr_rq_book[$key]['name']);			}			return $tr_rq_book;		}															}