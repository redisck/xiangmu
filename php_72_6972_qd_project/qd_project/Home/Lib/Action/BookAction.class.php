<?php	class BookAction extends Action{		public function index(){		//左侧图书分类		$classify=D("Book")->get_book_classify();		$this->assign("classify",$classify);				/**限时促销*/		$sail_info=D("Index")->get_time_sail_info();		foreach($sail_info as $key=>$value){			$arr=explode("_",$sail_info[$key]['image']);			$sail_info[$key]['image_first']=$arr[0];			$sail_info[$key]['image_last']=$arr[1];		}			//保存开始时间		$_SESSION['start_time']=$sail_info[0]['start_time'];			//保存结束时间		$_SESSION['end_time']=$sail_info[0]['end_time'];			//计算折扣		$sail_info_rebate=round(($sail_info[0]['rebate_price'] / $sail_info[0]['price'])*10,2);			//计算差价		$this->diff_price=number_format($sail_info[0]['price']-$sail_info[0]['rebate_price'],2);		$this->rebate=$sail_info_rebate; //折扣		foreach($sail_info as $key=>$value){			$sail_info[$key]['md5']=md5($sail_info[$key]['goods_id']);		}		$this->assign("sail_info",$sail_info);		/*限时促销结束*/				/**中部幻灯片*/		$ad=M("Ad");		$ad_list=$ad->where('type="图书页幻灯片"')->select();		foreach($ad_list as $key=>$value){			$arr=explode("_",$ad_list[$key]['image']);			$ad_list[$key]['image_first']=$arr[0];			$ad_list[$key]['image_last']=$arr[1];		}		$this->assign("ad_list",$ad_list);				/**中部广告*/		$ad_middle=$ad->where('type="图书页中部广告"')->select();		foreach($ad_middle as $key=>$value){			$arr=explode("_",$ad_middle[$key]['image']);			$ad_middle[$key]['image_first']=$arr[0];			$ad_middle[$key]['image_last']=$arr[1];		}		$this->assign("ad_middle",$ad_middle);		/** 精品套书*/		$whole_book=D("Book")->get_whole_book();		$this->assign("whole_book",$whole_book);				/**起点馆 */		//新书上架		$new_book=D("Book")->get_qd_new_book();		$this->assign("new_book",$new_book);		//连载全套 文本推荐		$serialize_book=D("Book")->get_qd_serialize_book();		//dump($serialize_book);		$end_book=D("Book")->get_qd_end_book();		$this->assign("serialize_book",$serialize_book);		$this->assign("end_book",$end_book);		//起点畅销榜		$qd_hot_book=D("Book")->get_qd_hot_book();		$this->assign("qd_hot_book",$qd_hot_book);		//起点系列作家丛书		$qd_author_book=D("Book")->get_qd_author_book();		$this->assign("author_book",$qd_author_book);		//传统馆作家丛书		$tr_author_book=D("Book")->get_tr_author_book();		$this->assign("tr_author_book",$tr_author_book);				//传统馆新书速递，名家新作		$tr_new_book=D("Book")->get_tr_new_book();		$tr_famous_author=D("Book")->get_tr_famous_author();		$this->assign("tr_new_book",$tr_new_book);		$this->assign("tr_famous_author",$tr_famous_author);				//传统馆连载全套，热搜图书				$tr_hot_search_book=D("Book")->get_tr_hot_search_book();				$this->assign("tr_hot_search_book",$tr_hot_search_book);				//传统馆畅销榜		$tr_hot_book=D("Book")->get_tr_hot_book();		$this->assign("tr_hot_book",$tr_hot_book);		//传统人气推荐		$tr_rq_book=D("Book")->get_tr_rq_book();		$this->assign("tr_rq_book",$tr_rq_book);		$this->display();	}		public function header(){			$this->display();		}		}	